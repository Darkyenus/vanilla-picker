/*!
 * Picker <https://github.com/Sphinxxxx/Picker>
 * A simple, easy to use, versatile and customisable Javascript colour picker.
 * Version 2.0.0-alpha.2  2018-02-02
 *
 * Copyright (c) 2014-2018 Adam Brooks (https://github.com/dissimulate), Andreas Borgen (https://github.com/Sphinxxxx)
 * Licensed under the ISC license.
 */
!function(e,t){if("function"==typeof define&&define.amd)define("Picker",["module"],t);else if("undefined"!=typeof exports)t(module);else{var i={exports:{}};t(i),e.Picker=i.exports}}(this,function(e){"use strict";var t=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function i(e){function t(e,t,i,n){var r=e.clientX;if(e=e.clientY,t){var o=t.getBoundingClientRect();r-=o.left,e-=o.top,i&&(r-=i[0],e-=i[1]),n&&(r=Math.max(0,Math.min(r,o.width)),e=Math.max(0,Math.min(e,o.height))),t!==d&&(null!==_?_:"circle"===t.nodeName||"ellipse"===t.nodeName)&&(r-=o.width/2,e-=o.height/2)}return b?[Math.round(r),Math.round(e)]:[r,e]}function i(e){(c=u?e.target.closest(u):{})&&(e.preventDefault(),e.stopPropagation(),h=u&&k?t(e,c):[0,0],p=t(e,d,h),b&&(p=p.map(Math.round)),f&&f(c,p))}function n(e){c&&(e.preventDefault(),e.stopPropagation(),e=t(e,d,h,!w),g(c,e,p))}function r(e){c&&((m||v)&&(e=t(e,d,h,!w),v&&p[0]===e[0]&&p[1]===e[1]&&v(c,p),m&&m(c,e,p)),c=null)}function o(e){r(a(e))}function s(e){return void 0!==e.buttons?1===e.buttons:1===e.which}function a(e){var t=e.targetTouches[0];return t||(t=e.changedTouches[0]),t.preventDefault=e.preventDefault.bind(e),t.stopPropagation=e.stopPropagation.bind(e),t}var l=Element.prototype;l.matches||(l.matches=l.msMatchesSelector||l.webkitMatchesSelector),l.closest||(l.closest=function(e){var t=this;do{if(t.matches(e))return t;t="svg"===t.tagName?t.parentNode:t.parentElement}while(t);return null});var c,h,p,d=(e=e||{}).container||document.documentElement,u=e.selector,g=e.callback||console.log,f=e.callbackDragStart,m=e.callbackDragEnd,v=e.callbackClick,b=!1!==e.roundCoords,w=!1!==e.dragOutside,k=e.handleOffset||!1!==e.handleOffset,_=null;switch(k){case"center":_=!0;break;case"topleft":case"top-left":_=!1}d.addEventListener("mousedown",function(e){s(e)&&i(e)}),d.addEventListener("touchstart",function(e){1!==e.touches.length?r(e):i(a(e))}),window.addEventListener("mousemove",function(e){c&&(s(e)?n(e):r(e))}),window.addEventListener("touchmove",function(e){1!==e.touches.length?r(e):n(a(e))}),window.addEventListener("mouseup",function(e){c&&!s(e)&&r(e)}),d.addEventListener("touchend",o),d.addEventListener("touchcancel",o)}var n=function(){function e(e,t){for(var i,n=0;n<t.length;n++)(i=t[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(t,i,n,r){var o=this;if(void 0===t);else if(Array.isArray(t))this.rgba=t;else if(void 0===n){var s=t&&(""+t).trim();s&&function(t){if(t.startsWith("#"))o.rgba=e._hexToRgb(t);else if(t.startsWith("hsl")){var i=t.match(/([\-\d\.e]+)/g).map(Number),n=i[0],r=i[1],s=i[2],a=i[3];void 0===a&&(a=1),n/=360,r/=100,s/=100,o.hsla=[n,r,s,a]}else{var l=t.match(/([\-\d\.e]+)/g).map(Number),c=l[0],h=l[1],p=l[2],d=l[3];void 0===d&&(d=1),o.rgba=[c,h,p,d]}}(s.toLowerCase())}else this.rgba=[t,i,n,void 0===r?1:r]}return e._hexToRgb=function(e){var t=(e.startsWith("#")?e.slice(1):e).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!t.match(/^(\w{8})$/))throw new Error("Unknown hex color; "+e);var i=t.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(e){return parseInt(e,16)});return i[3]/=255,i},e._rgbToHsl=function(e){var t=e[0],i=e[1],n=e[2],r=e[3];t/=255,i/=255,n/=255;var o,s,a=Math.max(t,i,n),l=Math.min(t,i,n),c=(a+l)/2;if(a===l)o=s=0;else{var h=a-l;s=.5<c?h/(2-a-l):h/(a+l),a===t?o=(i-n)/h+(i<n?6:0):a===i?o=(n-t)/h+2:a===n&&(o=(t-i)/h+4),o/=6}return[o,s,c,r]},e._hslToRgb=function(e){var t=e[0],i=e[1],n=e[2],r=e[3],o=void 0,s=void 0,a=void 0;if(0===i)o=s=a=n;else{var l=function(e,t,i){return 0>i&&(i+=1),1<i&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},c=.5>n?n*(1+i):n+i-n*i,h=2*n-c;o=l(h,c,t+1/3),s=l(h,c,t),a=l(h,c,t-1/3)}var p=[255*o,255*s,255*a].map(Math.round);return p[3]=r,p},n(e,[{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=e._hslToRgb(this._hsla)},set:function(e){3===e.length&&(e[3]=1),this._rgba=e,this._hsla=null}},{key:"rgbString",get:function(){return"rgb("+this.rgba.slice(0,3)+")"}},{key:"rgbaString",get:function(){return"rgba("+this.rgba+")"}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=e._rgbToHsl(this._rgba)},set:function(e){3===e.length&&(e[3]=1),this._hsla=e,this._rgba=null}},{key:"hslString",get:function(){var e=this.hsla;return"hsl("+360*e[0]+", "+100*e[1]+"%, "+100*e[2]+"%)"}},{key:"hslaString",get:function(){var e=this.hsla;return"hsla("+360*e[0]+", "+100*e[1]+"%, "+100*e[2]+"%, "+e[3]+")"}},{key:"hex",get:function(){return"#"+this.rgba.map(function(e,t){return 3>t?e.toString(16):(255*e).toString(16)}).map(function(e){return e.padStart(2,"0")}).join("")},set:function(t){this.rgba=e._hexToRgb(t)}}]),e}();document.documentElement.firstElementChild.appendChild(document.createElement("style")).textContent=".picker_wrapper{position:absolute;display:block;width:272px;padding:8px 0 8px 8px;box-sizing:border-box;overflow:visible;cursor:default;pointer-events:auto;z-index:1;color:red}.picker_wrapper,.picker_wrapper::before,.picker_wrapper::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,0.4)}.picker_wrapper::before,.picker_wrapper::after{content:\"\";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper::before{width:30px;height:30px;transform:skew(45deg);transform-origin:0 100%}.picker_wrapper::after{width:40px;height:40px;box-shadow:none}.picker_wrapper>div{margin:8px;float:left}.picker_hue{width:240px;height:20px;position:relative;margin-left:10px;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);outline:1px solid #cccccc}.picker_sl{width:203px;height:203px;position:relative;outline:1px solid #cccccc;background-color:red;background-image:linear-gradient(180deg, white, rgba(255,255,255,0) 50%),linear-gradient(0deg, black, transparent 50%),linear-gradient(90deg, gray, rgba(128,128,128,0))}.picker_alpha{width:20px;height:200px;position:relative;margin-left:10px;background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgrey'/%3E%3C/svg%3E\") top/contain white;outline:1px solid #cccccc}.picker_selector{position:absolute;display:block;width:24px;height:24px;margin:-12px;cursor:pointer;border:2px solid white;box-sizing:border-box;border-radius:20px;box-shadow:0 0 3px 1px #67b9ff;background:currentColor}.picker_slider .picker_selector{border-radius:2px}.picker_hue .picker_selector{top:50%}.picker_sl .picker_selector{left:100%}.picker_alpha .picker_selector{left:50%;background:none}.picker_sample{width:170px;height:30px;background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgrey'/%3E%3C/svg%3E\") left top/20px white;position:relative;margin-top:10px;outline:1px solid #aaaaaa}.picker_sample::before{content:\"\";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_done{width:53px;height:30px;line-height:30px;color:#444444;background:#e2e2e2;outline:1px solid #cccccc;box-shadow:0 0 3px 1px #eeeeee;text-align:center;cursor:pointer}\n";var o=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings={parent:document.body,orientation:"right",x:"auto",y:"auto",arrow_size:20},t instanceof HTMLElement)this.settings.parent=t;else for(var i in t)this.settings[i]=t[i];this.sliders={picker_hue:{down:!1,vertical:!0},picker_sl:{down:!1},picker_alpha:{down:!1,vertical:!0}},this.onDone=null,this.onChange=null}return t(e,[{key:"show",value:function(){var e=this.settings.parent;if(e.style.pointerEvents="none",this.domElement)this.domElement.style.display="";else{var t,i,n=(t='<div class="picker_wrapper">\n   <div class="picker_hue picker_slider">\n       <div class="picker_selector"></div>\n   </div>\n   <div class="picker_sl">\n       <div class="picker_selector"></div>\n   </div>\n   <div class="picker_alpha picker_slider">\n       <div class="picker_selector"></div>\n   </div>\n   <div class="picker_sample"></div>\n   <div class="picker_done">ok</div>\n</div>',(i=document.createElement("div")).innerHTML=t,i.firstElementChild);if(this.domElement=n,this._domH=n.querySelector(".picker_hue"),this._domSL=n.querySelector(".picker_sl"),this._domA=n.querySelector(".picker_alpha"),this._domSample=n.querySelector(".picker_sample"),this._domOkay=n.querySelector(".picker_done"),"absolute"!==getComputedStyle(e).position&&(e.style.position="relative"),e.appendChild(this.domElement),"auto"===this.settings.x)switch(this.settings.orientation){case"left":n.style.left=-n.offsetWidth-this.settings.arrow_size-4+"px";break;case"top":case"bottom":n.style.left=e.offsetWidth/2-this.settings.arrow_size+"px";break;case"center":case"centre":n.style.left=-n.offsetWidth/2+e.offsetWidth/2+"px";break;default:n.style.left=e.offsetWidth+this.settings.arrow_size+4+"px"}else n.style.left=parseInt(this.settings.x)+"px";if("auto"===this.settings.y)switch(this.settings.orientation){case"top":n.style.top=-n.offsetHeight-this.settings.arrow_size-4+"px";break;case"bottom":n.style.top=e.offsetHeight+this.settings.arrow_size+4+"px";break;case"center":case"centre":n.style.top=-e.offsetHeight/2+-n.offsetHeight/2+"px";break;default:n.style.top=e.offsetHeight/2-this.settings.arrow_size+"px"}else n.style.top=parseInt(this.settings.y)+"px";this.bind_events(),this.colour||this.setColor("#ff0")}}},{key:"bind_events",value:function(){var e=this;function t(e,t){function i(i,n){var r=n[0]/e.clientWidth,o=n[1]/e.clientHeight;t(r,o)}return{container:e,callback:i,callbackClick:i,dragOutside:!1}}i(t(this._domH,function(t,i){return e.setHSLA(t)})),i(t(this._domSL,function(t,i){return e.setHSLA(null,t,1-i)})),i(t(this._domA,function(t,i){return e.setHSLA(null,null,null,1-i)})),this.domElement.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault()}),window.addEventListener("mousedown",function(t){e.hide()}),this._domOkay.onclick=function(t){t.preventDefault(),t.stopPropagation(),e.done()}}},{key:"done",value:function(){this.hide(),this.onDone&&this.onDone(this.colour)}},{key:"hide",value:function(){this.domElement&&(this.domElement.style.display="none"),this.settings.parent.style.pointerEvents=""}},{key:"setColor",value:function(e){this.colour=this.color=new r(e),this.setHSLA()}},{key:"setHSLA",value:function(e,t,i,n){var r=arguments;if(r.length){for(var o=this.colour.hsla,s=0;s<r.length;s++){var a=r[s];(a||0===a)&&(o[s]=a)}this.colour.hsla=o}this.updateUI(),this.onChange&&this.onChange(this.colour)}},{key:"updateUI",value:function(){var e=this.colour,t=e.hsla,i="hsl("+360*t[0]+", 100%, 50%)",n=e.hslString,r=e.hslaString,o=this._domH,s=this._domSL,a=this._domA;function l(e,t,i){t.style.left=e.clientWidth*i+"px"}function c(e,t,i){t.style.top=e.clientHeight*i+"px"}l(o,o.firstElementChild,t[0]),this._domSL.style.backgroundColor=this._domH.style.color=i,l(s,s.firstElementChild,t[1]),c(s,s.firstElementChild,1-t[2]),s.style.color=n,c(a,a.firstElementChild,1-t[3]);var h="linear-gradient("+[n,n.replace("hsl","hsla").replace(")",", 0)")]+")";this._domA.style.backgroundImage=h+", url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgrey'/%3E%3C/svg%3E\")",this._domSample.style.color=r}}]),e}();e.exports=o});